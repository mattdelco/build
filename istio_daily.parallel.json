{
  "steps": [
    {
      "volumes": [
        {
          "name": "buildxfer",
          "path": "/xfer"
        }
      ],
      "id": "downloadSource",
      "name": "gcr.io/istio-io/istio-builder:0.3.2",
      "args": [ "./download_source_tree.sh", "-d", "-b", "$BRANCH_NAME", "-p", "$PROJECT_ID", "-o", "/xfer"]
    },
    {
      "volumes": [
        {
          "name": "buildxfer",
          "path": "/xfer"
        }
      ],
      "name": "gcr.io/istio-io/istio-builder:0.3.2",
      "dir": "auth",
      "id": "auth",
      "waitFor": [
	"downloadSource"
      ],
      "args": [ "./bin/daily_cloud_builder.sh", "-d", "-b", "$BRANCH_NAME", "-p", "$PROJECT_ID", "-o", "/xfer"]
    },
    {
      "volumes": [
        {
          "name": "buildxfer",
          "path": "/xfer"
        }
      ],
      "name": "gcr.io/istio-io/istio-builder:0.3.2",
      "dir": "mixer",
      "id": "mixer",
      "waitFor": [
	"downloadSource"
      ],
      "args": [ "./bin/daily_cloud_builder.sh", "-d", "-b", "$BRANCH_NAME", "-p", "$PROJECT_ID", "-o", "/xfer"]
    },
    {
      "volumes": [
        {
          "name": "buildxfer",
          "path": "/xfer"
        }
      ],
      "name": "gcr.io/istio-io/istio-builder:0.3.2",
      "env": [ "GOPATH=/tmp/gopath" ],
      "dir": "pilot",
      "id": "pilot",
      "waitFor": [
	"downloadSource"
      ],
      "args": [ "./bin/daily_cloud_builder.sh", "-d", "-b", "$BRANCH_NAME", "-p", "$PROJECT_ID", "-o", "/xfer"],
      "entrypoint": "bash"
    },
    {
      "volumes": [
	{
          "name": "buildxfer",
          "path": "/xfer"
        }
      ],
      "name": "gcr.io/istio-io/istio-builder:0.3.2",
      "dir": "proxy",
      "id": "proxy",
      "waitFor": [
	"downloadSource"
      ],
      "args": [ "./script/daily_cloud_builder.sh", "-d", "-b", "$BRANCH_NAME", "-p", "$PROJECT_ID", "-o", "/xfer"]
    },
    {
      "volumes": [
        {
          "name": "buildxfer",
          "path": "/xfer"
        }
      ],
      "name": "gcr.io/istio-io/istio-builder:0.3.2",
      "id": "storeArtifacts",
      "waitFor": [
	"auth",
	"mixer",
	"pilot",
	"proxy"
      ],
      "args": [ "./store_artifacts.sh", "-d", "-b", "$BRANCH_NAME", "-p", "$PROJECT_ID", "-o", "/xfer", "-x", "_dailyParallel" ]
    }
  ],
  "options": {
    "machineType": "N1_STANDARD_8"
  },
  "timeout": "3600s",
  "tags": [
    "daily"
  ]
}
